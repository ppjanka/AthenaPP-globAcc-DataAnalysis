
This is a set of Python diagnostics to be used with Athena++ simulations, particularly suited for global accretion disk models (see, e.g., Pjanka & Stone 2020). Generally intended for use with MHD simulations in spherical-polar coordinates with AMR and HDF5 output.

Note: this toolkit has been evolving over time and, unfortunately, I am not able to test all the pathways for correctness over time. Thus, *please* make sure to check that the results you obtain are sensible and self-consistent, and that no debugging is needed. (This is perhaps a good general advice as well ;)

### Final products

This folder contains scripts useful for in-depth analysis of the results. The scripts use pkl files generated by processing in previous steps of the analysis (see ../1_1stLook_and_processing/).

## Typical workflow

 Proceed with the files as numbered or in any order of interest. Processing settings in each script can be used to only extract some of the diagnostic products.

## Contents

 - 0_detailed_diagnostics.ipynb: a script with in-depth diagnostics of snapshots, time-averaged data and other simulation results,

 - 1_spiralFits.ipynb: identifies spiral structure and fits a linear model to it, extracts simple Doppler diagram from accretion disk data (see Pjanka & Stone 2020),

 - 2_isosurfaces.ipynb: finds and plots density isosurfaces from the data,

 - 3_kinHelicity.ipynb: an analysis of the kinetic helicity behaviour in the data,

 - 4_paperPlots.ipynb: a set of final plots used in Pjanka & Stone (2020),

 - environment.yml: an Anaconda snapshot of the Python environment to be used with the scripts in this repo.

 - diagnostics_header.py, diagnostics_vars.py, and diagnostics_ops.py: see description in ../1_1stLook_and_processing/README.md

 - athena_read.py: a script from [Athena++](https://github.com/PrincetonUniversity/athena-public-version) handling read-in of the simulations' .athdf (hdf5) outputs.

## Contributing

Written by Patryk Pjanka to aid design and implementation of global accretion disk simulations (e.g., Pjanka & Stone 2020). Contains elements of [Athena++](https://github.com/PrincetonUniversity/athena-public-version) to aid read-in of the simulations' .athdf (hdf5) outputs.

## License
Per Athena++ use [license](https://github.com/PrincetonUniversity/athena-public-version/blob/master/LICENSE), BSD 3-Clause License (see the root folder of this repo).